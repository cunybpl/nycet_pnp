{{ partial "calculation_methodology/breadcrumb.html" . }}
{{ partial "calculation_methodology/header.html" . }}
<section id="{{ .Params.type }}-page-{{ .Params.type }}" class="container {{ .Params.type }}-page-content"
  style="color: black;"
>
  <div class="row" style="padding-top: 3rem; padding-bottom: 5rem;">
    <div id="guide-mg-side-nav" class="col-3 pl-0 pr-3">
      <div class="mg-toc">
        <span class="text-muted font-weight-bold toc-header">{{ .Title }}</span>
        {{ .TableOfContents }}
        <div class="pl-3 pt-5">
          <a id="back-to-top" href="#" class="" role="button">
            <span class="mr-2">Back to top</span><i class="fa fa-arrow-up"></i>
          </a>
        </div>
      </div>
      
    </div>
    <div class="col-9">
      <div class="content">
        {{ .Content }}
      </div>
    </div>
  </div>
</section>
<section id="{{ .Params.type }}-page-related-systems" class="container {{ .Params.type }}-page-content px-0">
  {{ $total_related_systems := 0 }}
  {{ $systems := "" }}
  {{ if isset .Params "related_systems" }}
    {{ $total_related_systems = .Params.related_systems | len }}
    {{ $systems = .Params.related_systems }}
  {{ end }}
  <div class="d-flex align-items-center mb-1" style="padding-top: 4rem;">
    <h3 class="mb-0">
      {{ $total_related_systems }} Related Systems
    </h3>
    <a class="ml-4" href="{{ .Site.BaseURL }}">Browse All Systems</a>
  </div>
  <div class="d-flex flex-wrap justify-content-between py-4">
  {{ range .Site.RegularPages }}
    {{ if in $systems .Title }}
      {{ partial "guides/related.html" . }}
    {{ end }}
  {{ end }}
</section>
<section id="{{ .Params.type }}-page-related-components" class="container {{ .Params.type }}-page-content px-0">
  {{ $total_related_components := 0 }}
  {{ $components := "" }}
  {{ if isset .Params "related_components" }}
    {{ $total_related_components = .Params.related_components | len }}
    {{ $components = .Params.related_components }}
  {{ end }}
  <div class="d-flex align-items-center mb-1" style="padding-top: 4rem;">
    <h3 class="mb-0">
      {{ $total_related_components }} Related Components
    </h3>
    <a class="ml-4" href="{{ .Site.BaseURL }}">Browse All Components</a>
  </div>
  <div class="d-flex flex-wrap justify-content-between py-4">
  {{ range .Site.RegularPages }}
    {{ if in $components .Title }}
      {{ partial "guides/related.html" . }}
    {{ end }}
  {{ end }}
</section>

<script>
  function hideRelatedSystems() {
    $('#{{ .Params.type }}-page-related-systems').hide();
  }
  function hideRelatedComponents() {
    $('#{{ .Params.type }}-page-related-components').hide();
  }
  $('#TableOfContents > ul > li').on('click', (event) => {
    $('#TableOfContents > ul > li').removeClass('active-item');
    $(event.currentTarget).addClass('active-item');
  })

  $(document).ready(() => {
    $(window).scroll(() => {
      if ($(this).scrollTop() > 500) {
        $('#back-to-top').fadeIn();
      } else {
        $('#back-to-top').fadeOut();
      }
    });
    $('#back-to-top').click(() => {
      $('body,html').animate({
        scrollTop: 0
      }, 400);
      return false;
    });
  });

  hideRelatedSystems()
  hideRelatedComponents()
</script>
