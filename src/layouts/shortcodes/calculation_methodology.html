<section class="card card-block my-4">
  {{ $calculation_methodology_id := .Get "calculation_methodology_id" }}
  {{ range where .Site.RegularPages "Params.type" "calculation"  }}
    {{ if eq $calculation_methodology_id .Params.calculation_methodology_id }}
      <div class="short-card-wrapper d-flex">
        <div class="short-card-content">
          <div class="short-card-text">
            <h5 class="mb-2 content-card-title">
              <span class="short-card-header">{{ .Title }}</span>
              <span class="chip content-chip px-3 py-2">{{ .Params.type | title }}</span>
            </h5>
            <p class="mb-0 content-card-excerpt">
              {{ .Params.excerpt | truncate 250 }}
            </p>
            {{ if isset .Params "associated_calculators" }}
            <div class="px-4">
              <h6 class="related-title">Related Calculators</h6>
              <ul id="list-calcs" class="mt-n3 mb-0 card-related-list">
                {{ $counter := 0 }}
                {{ $calculators := where site.Data.downloadable_files.files "name" "in" .Params.associated_calculators }}
                {{ range $calculators }}
                <!-- This loop is for counter -->
                  {{ $counter = add $counter 1 }}
                {{ end }}
                {{ range first 3 $calculators }}
                <!-- This loop is for the actual data -->
                  {{ partial "thumbnail/associated_calculators.html" . }}
                {{ end }}
              </ul>
            </div>
          {{ end }}
          </div>
        </div>
        <a class="short-card-link d-flex" href="{{ .Params.url | relURL }}">
            <i class="fa fa-arrow-right"></i>
        </a>
      </div>
    {{ end }}
  {{ end }}
</section>